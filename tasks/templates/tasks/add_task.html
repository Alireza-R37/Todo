<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css">

<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>افزودن تسک جدید</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <!-- Bootstrap RTL -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css">
  <style>
    body{ background:#f7f7fb; }
    .card-clean{ border:0; border-radius:16px; box-shadow:0 10px 35px rgba(0,0,0,.08); }
    /* بهبود نمایش خطاهای پیش‌فرض جنگو */
    .add-form ul.errorlist{ margin:.35rem 0 0; padding:0; list-style:none; color:#dc3545; font-size:.9rem; }
    .add-form label{ display:block; margin-bottom:.35rem; font-weight:600; }
  </style>
</head>
<body>
  <div class="container py-4">
    <div class="row justify-content-center">
      <div class="col-12 col-md-10 col-lg-8">
        <div class="card card-clean">
          <div class="card-body p-4">
            <h1 class="h5 mb-3">افزودن تسک جدید</h1>

            <form method="POST" class="add-form" novalidate>
              {% csrf_token %}
              {{ ffform.as_p }}
              <button type="submit" class="btn btn-primary w-100">ذخیره</button>
            </form>

            <hr class="my-4">
            <a href="{% url 'tasks:task_list' %}" class="btn btn-outline-secondary w-100">
              بازگشت به لیست تسک‌ها
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS (اختیاری برای کامپوننت‌ها) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // افزودن کلاس‌های Bootstrap به خروجی ffform.as_p بدون تغییر منطق
    (function () {
      const form = document.querySelector('.add-form');
      if (!form) return;

      // هر پاراگراف خروجی as_p فاصله استاندارد بگیرد
      form.querySelectorAll('p').forEach(p => p.classList.add('mb-3'));

      // کلاس‌دهی به ورودی‌ها
      form.querySelectorAll('input, select, textarea').forEach(el => {
        if (el.type === 'hidden') return;

        if (el.type === 'checkbox' || el.type === 'radio') {
          el.classList.add('form-check-input');
          const p = el.closest('p');
          if (p) p.classList.add('form-check', 'mb-3');
          const label = p ? p.querySelector('label') : null;
          if (label) label.classList.add('form-check-label', 'ms-2');
        } else {
          el.classList.add('form-control', 'form-control-lg');
        }
      });

      // لیبل‌ها
      form.querySelectorAll('label').forEach(l => l.classList.add('form-label'));
    })();
  </script>
</body>
</html>
